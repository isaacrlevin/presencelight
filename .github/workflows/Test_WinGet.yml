name: Winget
on:
  workflow_dispatch:
    inputs:
      Version:
        description: 'Release'
        required: true
        default: '5.0'
        type: string
        
jobs:
  publish:
    runs-on: windows-latest
    defaults:
      run:
        shell: pwsh
        working-directory: ${{ github.workspace }}/Build/winget
    env:
      WINGETCREATE_TOKEN: ${{ secrets.WINGETCREATE_TOKEN }}
    steps:
    - name: Winget Publish
      uses: isaacrlevin/winget-publish-action@v.7
      with:
        publish-type: 'Create'
        user: "isaaclevin"
        package: "presencelight"
        version: "${{ inputs.Version }}"
        url: "https://github.com/isaacrlevin/presencelight/releases/download/Desktop-v${{ inputs.Version }}/PresenceLight.Package_${{ inputs.Version }}.0_x64_x86_ARM64.appxbundle"
        token: ${{ secrets.WINGETCREATE_TOKEN }}
        short-description: "PresenceLight is a solution to broadcast your various statuses to light bulbs."
        arch: x64
        installer-type: "appx"
        publisher: "Isaac Levin"
        package-name: "PresenceLight"
        license: "MIT License"        
        family-name: ""
    - name: Setup tmate session
      if: ${{ failure() }}
      uses: mxschmitt/action-tmate@v3
      
      
      
